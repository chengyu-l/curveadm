部署预检
===

预检简介
---

预检模块用来提前检测那些可能导致用户部署失败的因素，以提高用户部署的成功率。


> :bulb: **提醒：**
>
> 我们默认会在执行部署的时候运行预检功能，用户也可以通过 `-k` 选项在部署时跳过预检，
> 但是这是我们极其不建议的。

执行预检
---

```shell
$ curveadm precheck
```

目前默认会执行 `拓扑`、`SSH`、`权限`、`内核`、`网络`、`时间`、`服务 ` 这 6 个预检项，用户在确保没有问题的情况下，可通过 `skip` 选项跳过指定预检项：

```shell
$ curveadm precheck --skip <item>
```

### 预检项说明

| 检查项 | 跳过选项   | 说明                                          |
| :---   | :---       | :---                                          |
| 拓扑   | topology   | 检查集群拓扑的合法性                          |
| SSH    | ssh        | 检查 SSH 的连通性                             |
| 权限   | permission | 检查当前用户执行 docker、创建目录等权限       |
| 内核   | kernel     | 检查内核版本、内核模块是否满足要求            |
| 网络   | network    | 检查网络连通性、防火墙等                      |
| 时间   | date       | 检查主机之间的时间差是否过大                  |
| 服务   | service    | 检查服务数量、chunkfile pool、S3 配置有效性等 |

> :bulb: **提醒：**
>
> 当出现预检失败时，我们强烈建议用户根据报告的[错误码][errno]以及其提供的解决方案一步步排除问题，
> 并最终通过所有预检。我们非常不建议在出现预检失败时，选择跳过该检查项，
> 因为这会给之后的实际部署留下隐患，导致部署失败。我们确保预检的每一项都是部署所必须的，请在部署前确保通过所有预检项。

[errno]: https://github.com/opencurve/curveadm/wiki/errno
